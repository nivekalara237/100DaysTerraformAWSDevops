<div class=" mx-auto overflow-hidden">
  <div class="px-4 py-2">
    <h1 class="text-gray-800 font-bold text-2xl capitalize">To-Do Task List
      <span *ngIf="todo?.name" class="underline font-extrabold text-blue-800 italic">
        #{{ todo.name.trim() }}
      </span>
    </h1>
  </div>
  <form (ngSubmit)="addTask()" [formGroup]="formCreateTask" class=" px-4 py-2" novalidate>
    <div class="flex items-start align-baseline border-b-2 border-teal-500 py-2">
      <textarea
        class="appearance-none bg-transparent border-none w-full text-gray-700 mr-3 py-1 px-2 leading-tight focus:outline-none"
        formControlName="taskName" id="taskName"
        name="taskName"
        ngSkipHiydration placeholder="Add a task" rows="2">
      </textarea>
      @if (nameCtrl.invalid && (nameCtrl.dirty || nameCtrl.touched)) {
        <div class="mt-2 text-sm text-red-700 dark:text-red-500">
          <div class="font-light" *ngIf="nameCtrl.hasError('required')">The name is required</div>
        </div>
      }
      <button
        class="flex-shrink-0 bg-teal-500 hover:bg-teal-700 border-teal-500 hover:border-teal-700 text-sm border-4 text-white py-1 px-2 rounded"
        type="submit">
        Add
      </button>
    </div>
    <div class="mt-0">
      <a (click)="expand()" class="font-extralight text-xs text-green-600 "
         href="javascript:void(0)">
        @if (expendAdvanced) {
          [<span class="font-bold">-</span>]
        } @else {
          [<span class="font-bold">+</span>]
        }
        Advanced
      </a>
    </div>

    <div [hidden]="!expendAdvanced" class="mt-2">
      <div #daterangepicker class="flex items-center" date-rangepicker id="date-range-picker">
        <div class="relative">
          <div class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none">
            <svg aria-hidden="true" class="w-4 h-4 text-gray-500 dark:text-gray-400" fill="currentColor"
                 viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z" />
            </svg>
          </div>
          <input
            class="bg-gray-50 border border-gray-300 border-r-white text-gray-900 text-sm rounded-r-none rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full ps-10 p-2.5  dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
            formControlName="startDate"
            id="datepicker-range-start" name="start"
            placeholder="Select date start"
            type="text">
        </div>
        <div class="relative">
          <div class="absolute inset-y-0 end-0 top-0 flex items-center pe-3.5 pointer-events-none">
            <svg aria-hidden="true" class="w-4 h-4 text-gray-500 dark:text-gray-400" fill="currentColor"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path clip-rule="evenodd"
                    d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm11-4a1 1 0 1 0-2 0v4a1 1 0 0 0 .293.707l3 3a1 1 0 0 0 1.414-1.414L13 11.586V8Z"
                    fill-rule="evenodd" />
            </svg>
          </div>
          <input
            class="bg-gray-50 border leading-none border-gray-300 border-l-white text-gray-900 text-sm rounded-l-none rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
            formControlName="startTime" id="time" max="18:00" min="09:00" type="time" value="00:00" />
        </div>
        <span class="mx-4 text-gray-500">to</span>
        <div class="relative">
          <div class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none">
            <svg aria-hidden="true" class="w-4 h-4 text-gray-500 dark:text-gray-400" fill="currentColor"
                 viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z" />
            </svg>
          </div>
          <input
            class="bg-gray-50 border border-gray-300 border-r-white rounded-r-none text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full ps-10 p-2.5  dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
            formControlName="endDate"
            id="datepicker-range-end" name="end"
            placeholder="Select date end"
            type="text">
        </div>
        <div class="relative">
          <div class="absolute inset-y-0 end-0 top-0 flex items-center pe-3.5 pointer-events-none">
            <svg aria-hidden="true" class="w-4 h-4 text-gray-500 dark:text-gray-400" fill="currentColor"
                 viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path clip-rule="evenodd"
                    d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm11-4a1 1 0 1 0-2 0v4a1 1 0 0 0 .293.707l3 3a1 1 0 0 0 1.414-1.414L13 11.586V8Z"
                    fill-rule="evenodd" />
            </svg>
          </div>
          <input
            class="bg-gray-50 border leading-none border-gray-300 border-l-white text-gray-900 text-sm rounded-l-none rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
            formControlName="endTime"
            id="endtime"
            max="18:00"
            min="09:00" type="time" value="00:00" />
        </div>
      </div>
    </div>
  </form>
  <ul class="divide-y divide-gray-200 px-4">
    @for (task of tasks; track task.id; let idx = $index) {
      <li class="flex items-center py-4">
        <div class="flex items-center h-5">
          <input (change)="completeOrNotTask($event, task)"
                 [checked]="task.status === TaskStatusEnum.COMPLETED"
                 aria-describedby="helper-checkbox-text" type="checkbox" [value]="task"
                 class="w-5 h-5 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"
                 id="todo-{{ idx }}" name="todo-task-{{ idx }}">
        </div>
        <div class="ms-2 text-sm">
          <label [ngClass]="{ 'line-through': task.status === TaskStatusEnum.COMPLETED  }" for="todo-{{ idx }}"
                 class="font-medium text-lg text-gray-900 dark:text-gray-300">
            {{ task.name }}
          </label>
          <div id="helper-checkbox-text" class="text-xs mt-1 font-normal text-gray-500 dark:text-gray-300">
            @switch (task.status) {
              @case (TaskStatusEnum.COMPLETED) {
                <span
                  class="bg-green-100 text-green-800 text-xs font-medium inline-flex items-center px-2.5 py-0.5 rounded me-2 dark:bg-green-700 dark:text-green-400 border border-green-500 ">
                  <svg class="w-4 h-4 text-green-500 dark:text-white" aria-hidden="true"
                       xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                       viewBox="0 0 24 24">
                    <path fill-rule="evenodd"
                          d="M12 2c-.791 0-1.55.314-2.11.874l-.893.893a.985.985 0 0 1-.696.288H7.04A2.984 2.984 0 0 0 4.055 7.04v1.262a.986.986 0 0 1-.288.696l-.893.893a2.984 2.984 0 0 0 0 4.22l.893.893a.985.985 0 0 1 .288.696v1.262a2.984 2.984 0 0 0 2.984 2.984h1.262c.261 0 .512.104.696.288l.893.893a2.984 2.984 0 0 0 4.22 0l.893-.893a.985.985 0 0 1 .696-.288h1.262a2.984 2.984 0 0 0 2.984-2.984V15.7c0-.261.104-.512.288-.696l.893-.893a2.984 2.984 0 0 0 0-4.22l-.893-.893a.985.985 0 0 1-.288-.696V7.04a2.984 2.984 0 0 0-2.984-2.984h-1.262a.985.985 0 0 1-.696-.288l-.893-.893A2.984 2.984 0 0 0 12 2Zm3.683 7.73a1 1 0 1 0-1.414-1.413l-4.253 4.253-1.277-1.277a1 1 0 0 0-1.415 1.414l1.985 1.984a1 1 0 0 0 1.414 0l4.96-4.96Z"
                          clip-rule="evenodd" />
                  </svg>

                  <span class="capitalize ml-1">{{ task.status?.toLowerCase() }}</span>
                </span>
              }
              @case (TaskStatusEnum.RUNNING) {
                <span
                  class="bg-blue-100 text-blue-800 text-xs font-medium inline-flex items-center px-2.5 py-0.5 rounded me-2 dark:bg-blue-700 dark:text-blue-400 border border-blue-500 ">
                  <svg class="w-4 h-4 text-blue-500 dark:text-white" aria-hidden="true"
                       xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                       viewBox="0 0 24 24">
                    <path fill-rule="evenodd"
                          d="M5.5 3a1 1 0 0 0 0 2H7v2.333a3 3 0 0 0 .556 1.74l1.57 2.814A1.1 1.1 0 0 0 9.2 12a.998.998 0 0 0-.073.113l-1.57 2.814A3 3 0 0 0 7 16.667V19H5.5a1 1 0 1 0 0 2h13a1 1 0 1 0 0-2H17v-2.333a3 3 0 0 0-.56-1.745l-1.616-2.82a1 1 0 0 0-.067-.102 1 1 0 0 0 .067-.103l1.616-2.819A3 3 0 0 0 17 7.333V5h1.5a1 1 0 1 0 0-2h-13Z"
                          clip-rule="evenodd" />
                  </svg>

                  <span class="capitalize ml-1">{{ task.status?.toLowerCase() }}</span>
                </span>
              }
              @case (TaskStatusEnum.DUE) {
                <span
                  class="bg-blue-100 text-blue-800 text-xs font-medium inline-flex items-center px-2.5 py-0.5 rounded me-2 dark:bg-blue-700 dark:text-blue-400 border border-blue-500 ">
                  <svg class="w-4 h-4 text-blue-500 dark:text-white" aria-hidden="true"
                       xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="m16 10 3-3m0 0-3-3m3 3H5v3m3 4-3 3m0 0 3 3m-3-3h14v-3" />
                  </svg>
                  <span class="capitalize ml-1">{{ task.status?.toLowerCase() }}</span>
                </span>
              }
              @case (TaskStatusEnum.CANCELLED) {
              }
              @default {

              }
            }
            <span
              class="inline-flex items-center bg-gray-100 text-gray-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded-full dark:bg-gray-700 dark:text-gray-300">
              <svg class="w-3 h-3 mr-1 text-gray-800 dark:text-white" aria-hidden="true"
                   xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                <path fill-rule="evenodd"
                      d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm11-4a1 1 0 1 0-2 0v4a1 1 0 0 0 .293.707l3 3a1 1 0 0 0 1.414-1.414L13 11.586V8Z"
                      clip-rule="evenodd" />
              </svg>
              {{ _timeAgo(task.createdAt) }}
            </span>
            <a href="javascript:void(0)" (click)="deleteTask(task)"
               class="inline-flex items-center bg-red-100 hover:bg-red-200 text-red-800 text-xs font-semibold me-1 px-1 py-0.5 rounded dark:bg-red-700 dark:text-red-400 border border-red-400 justify-center">
              <svg class="w-3 h-3 text-red-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
                   width="24" height="24" fill="none" viewBox="0 0 24 24">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z" />
              </svg>
            </a>
          </div>
        </div>
      </li>
    }
  </ul>
</div>
